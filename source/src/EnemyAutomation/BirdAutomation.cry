import Math;

class BirdAutomation {
	field counter = 0;
	// TODO: replace with enum.
	field mode = 'stalk'; // 'right' | 'left'
	field sprite;
	field bikeLevel;

	constructor(sprite, onBikeLevel) {
		sprite.isEnemy = true;
		this.sprite = sprite;
		this.bikeLevel = onBikeLevel;
	}
		
	function doStuff(scene) {
		this.counter++;
		p = scene.player;
		sprite = this.sprite;
		if (this.mode == 'stalk') {
			dy = p.y - this.sprite.y;
			
			if (Math.abs(dy) < 6) {
				this.mode = 'right';
			} else if (dy > 0) {
				this.sprite.dy += 3;
			} else {
				this.sprite.dy -= 3;
			}
		} else if (this.mode == 'right') {
			if (sprite.x < p.x) {
				sprite.dx = 6;
			} else {
				this.mode = 'left';
			}
		} else { // mode == 'left'
			spriteX = sprite.x;
			if (this.bikeLevel) {
				spriteX -= this.counter * BIKE_SPEED;
			}
			
			if (spriteX > 7) {
				sprite.dx = -6;
			} else {
				this.mode = 'stalk';
			}
		}
		
		if (this.bikeLevel) {
			sprite.dx += BIKE_SPEED;
		}
	}
}
